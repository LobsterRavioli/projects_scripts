@echo off
setlocal EnableDelayedExpansion
cd /d %CD%

rem WHERE YOU WANT TO SAVE FILES
rem "%~dp0" is a variable for the same folder as this script, so files should be saved in the same folder.
SET "_SAVE_DIR=%~dp0"

SET "BACKBONE_INSTALL_DIR=%LocalAppData%\backbone-cli\backbone-cli.jar"
SET "BACKBONE_JRE_DIR=%LocalAppData%\backbone-cli\java-runtime\bin"
SET CMD_ARGS=""

rem check if user wants to force isntall or update the CLI
if "%1"=="install" goto install_cli
if "%1"=="update" goto install_cli
if "%1"=="upgrade" goto install_cli

SET CMD_ARGS=%*

rem check if we can run backbone CLI
if exist "%BACKBONE_INSTALL_DIR%" (
    goto execute_cmd
)
echo Sella Backbone command line tools are not installed

:install_cli
echo installing Sella Backbone command line tools...
SET VERSION=%2
powershell -command "$utf16Base64Command=[Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes([Text.Encoding]::Utf8.GetString([Convert]::FromBase64String(\"IyRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZSc7DQppZiAoJG51bGwgLWVxICRlbnY6QVpfUEFUKSB7ICRlbnY6QVpfUEFUID0gJ293NnhqamY1M3Fya3ZsdG95c2w2Nng3NWxsYmFqM2kyY2h3aGh6Mm9hYTduc3BlM2ZmdnEnIH0NCmlmICgkbnVsbCAtZXEgJGVudjpBWl9WSUVXX05BTUUpIHsgJGVudjpBWl9WSUVXX05BTUUgPSAnUmVsZWFzZScgfQ0KDQokQnl0ZXMgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCI6JCgkZW52OkFaX1BBVCkiKQ0KJEVuY29kZWRUZXh0ID1bQ29udmVydF06OlRvQmFzZTY0U3RyaW5nKCRCeXRlcykNCiRBWl9BVVRIT1JJWkFUSU9OX0hFQURFUj0iQmFzaWMgJEVuY29kZWRUZXh0Ig0KDQokQkFDS0JPTkVfUFJPUEVSVFlfRklMRT0iIg0KJG1haW4gPSB7DQogICAgJHZlcnNpb24gPSAkZW52OlZFUlNJT04NCiAgICBpZiAoJHZlcnNpb24pIHsNCiAgICAgICAgV3JpdGUtSG9zdCAiZm9yY2UgaW5zdGFsbGluZyB2ZXJzaW9uOiAiJHZlcnNpb24NCiAgICB9ICAgIA0KDQogICAgIyBHZXQgUGFja2FnZXMNCiAgICAkcGFja2FnZXMgPSAoSW52b2tlLUF6dXJlLUFQSSAtaG9zdE5hbWUgImZlZWRzIiAtcGF0aCAiQlNFLUFyY2hpdGV0dHVyYUlUL19hcGlzL3BhY2thZ2luZy9mZWVkcy9CU0UtQXJjaGl0ZXR0dXJhSXQvcGFja2FnZXM/YXBpLXZlcnNpb249Ny4wLXByZXZpZXcuMSZpbmNsdWRlQWxsVmVyc2lvbnM9dHJ1ZSIpDQogICAgJGFydGlmYWN0TmFtZSA9ICJpdC5zZWxsYS5iYWNrYm9uZTpiYWNrYm9uZS1jbGkiDQogICAgJHBhY2thZ2UgPSAkcGFja2FnZXMgfCB3aGVyZSB7ICRfLm5hbWUgLWVxICIkYXJ0aWZhY3ROYW1lIiB9DQoNCiAgICAjIGdldCB2ZXJzaW9uIGFycmF5DQogICAgJHZlcnNpb25zID0gSW52b2tlLUF6dXJlLUFQSSAtaG9zdE5hbWUgImZlZWRzIiAtdXJpICRwYWNrYWdlLl9saW5rcy52ZXJzaW9ucy5ocmVmDQoNCiAgICAjIFNvcnQgdGhlIGFycmF5IGJhc2VkIG9uIHRoZSBkYXRlDQogICAgJHZlcnNpb25zID0gJHZlcnNpb25zIHwgU29ydC1PYmplY3Qgew0KICAgICAgICB0cnkgeyBbRGF0ZVRpbWVdOjpQYXJzZUV4YWN0KCRfLnB1Ymxpc2hEYXRlLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzLmZmZmZmZmZmJ1onIiwgJG51bGwpIH0gY2F0Y2gge30NCiAgICAgICAgdHJ5IHsgW0RhdGVUaW1lXTo6UGFyc2VFeGFjdCgkXy5wdWJsaXNoRGF0ZSwgInl5eXktTU0tZGQnVCdISDptbTpzcy5mZmZmZmZmJ1onIiwgJG51bGwpIH0gY2F0Y2gge30NCiAgICAgICAgdHJ5IHsgW0RhdGVUaW1lXTo6UGFyc2VFeGFjdCgkXy5wdWJsaXNoRGF0ZSwgInl5eXktTU0tZGQnVCdISDptbTpzcy5mZmZmZmYnWiciLCAkbnVsbCkgfSBjYXRjaCB7fQ0KICAgICAgICB0cnkgeyBbRGF0ZVRpbWVdOjpQYXJzZUV4YWN0KCRfLnB1Ymxpc2hEYXRlLCAieXl5eS1NTS1kZCdUJ0hIOm1tOnNzLmZmZmZmJ1onIiwgJG51bGwpIH0gY2F0Y2gge30NCiAgICAgICAgdHJ5IHsgW0RhdGVUaW1lXTo6UGFyc2VFeGFjdCgkXy5wdWJsaXNoRGF0ZSwgInl5eXktTU0tZGQnVCdISDptbTpzcy5mZmZmJ1onIiwgJG51bGwpIH0gY2F0Y2gge30NCiAgICB9IC1EZXNjZW5kaW5nDQoNCiAgICANCg0KICAgICMgZ2V0IHZlcnNpb24gb2JqZWN0DQogICAgaWYgKCR2ZXJzaW9uIC1lcSAkbnVsbCl7DQogICAgICAgICMgZ2V0IHZlcnNpb24gb2JqZWN0IGJ5IHRha2luZyB0aGUgbGFzdCBSZWxlYXNlIHZlcnNpb24NCiAgICAgICAgJHZlcnNpb25PYmplY3QgPSAkdmVyc2lvbnMgfCB3aGVyZSB7JF8udmlld3MubmFtZSAtZXEgJGVudjpBWl9WSUVXX05BTUV9IHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMQ0KICAgICAgICBXcml0ZS1Ib3N0ICJpbnN0YWxsaW5nIHZlcnNpb24gIiR2ZXJzaW9uT2JqZWN0LnZlcnNpb24NCiAgICB9IGVsc2Ugew0KICAgICAgICAkdmVyc2lvbk9iamVjdCA9ICR2ZXJzaW9ucyB8IHdoZXJlIHskXy52ZXJzaW9uIC1lcSAkdmVyc2lvbn0NCiAgICB9DQoNCiAgICAjIENoZWNrIGlmIHZlcnNpb24gb2JqZWN0IGlzIHByZXNlbnQNCiAgICBpZiAoJHZlcnNpb25PYmplY3QgLWVxICRudWxsKSB7DQogICAgICAgIFdyaXRlLUhvc3QgIlZlcnNpb24gbm90IGZvdW5kLiINCiAgICAgICAgZXhpdCAxDQogICAgfQ0KDQogICAgIyBnZXQgemlwIGZpbGUgdXJsDQogICAgJGZpbGUgPSAkdmVyc2lvbk9iamVjdC5maWxlcyB8IFdoZXJlLU9iamVjdCB7ICRfLm5hbWUgLWxpa2UgIip6aXAiIH0gfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxDQogICAgaWYgKCRmaWxlIC1lcSAkbnVsbCl7DQogICAgICAgIFdyaXRlLUhvc3QgIlZlcnNpb24gemlwIGZpbGUgbm90IGZvdW5kLiINCiAgICAgICAgZXhpdCAxDQogICAgfQ0KICAgICRmaWxlVVJMPSJodHRwczovL3BrZ3MuZGV2LmF6dXJlLmNvbS9jZW50cmljby9CU0UtQXJjaGl0ZXR0dXJhSVQvX2FwaXMvcGFja2FnaW5nL2ZlZWRzL0JTRS1BcmNoaXRldHR1cmFJVC9tYXZlbi9pdC5zZWxsYS5iYWNrYm9uZS9iYWNrYm9uZS1jbGkvJCgkdmVyc2lvbk9iamVjdC52ZXJzaW9uKS8kKCRmaWxlLm5hbWUpL2NvbnRlbnQiDQoNCiAgICAjIERvd25sb2FkIHRoZSB6aXAsIGV4dHJhY3QgdGhlIGZpbGUgYW5kIGRlbGV0ZSB1bnVzZWZ1bCBmaWxlcw0KICAgICR6aXBGaWxlUGF0aCA9ICJ0bXAuemlwIg0KICAgICRleHRyYWN0UGF0aCA9ICJ0bXAiDQogICAgJGRlc3RpbmF0aW9uUGF0aCA9ICIkKCRlbnY6TG9jYWxBcHBEYXRhKVxiYWNrYm9uZS1jbGkiDQoNCiAgICBEb3dubG9hZEZpbGUgJGZpbGVVUkwgJHppcEZpbGVQYXRoDQogICAgIyBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICIkZmlsZVVSTCIgLUhlYWRlcnMgQHsnQXV0aG9yaXphdGlvbicgPSAkQVpfQVVUSE9SSVpBVElPTl9IRUFERVI7fSAtT3V0RmlsZSAkemlwRmlsZVBhdGgNCiAgICAjIFZlcmlmaWNhIHNlIGlsIGZpbGUgWklQIGVzaXN0ZQ0KICAgIA0KICAgIGlmIChUZXN0LVBhdGggJHppcEZpbGVQYXRoKSB7DQogICAgICAgICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScNCiAgICAgICAgI2RlbGV0ZSBvbGQgY2xpIGZvbGRlcg0KICAgICAgICBpZiAoVGVzdC1QYXRoICIkZGVzdGluYXRpb25QYXRoIiApIHsNCiAgICAgICAgICAgIFJlbW92ZS1JdGVtIC1QYXRoICIkZGVzdGluYXRpb25QYXRoIiAtUmVjdXJzZSAtRm9yY2UNCiAgICAgICAgfQ0KDQogICAgICAgICMgRXN0cmEgaWwgY29udGVudXRvIGRlbCBmaWxlIFpJUCBuZWxsYSBjYXJ0ZWxsYSBkaSBlc3RyYXppb25lDQogICAgICAgIA0KICAgICAgICBFeHBhbmQtQXJjaGl2ZSAtUGF0aCAkemlwRmlsZVBhdGggLURlc3RpbmF0aW9uUGF0aCAkZXh0cmFjdFBhdGggLUZvcmNlDQogICAgICAgIA0KDQogICAgICAgICMgQ29waWEgaWwgY29udGVudXRvIGVzdHJhdHRvIG5lbGxhIGNhcnRlbGxhIGRpIGRlc3RpbmF6aW9uZQ0KICAgICAgICBDb3B5LUl0ZW0gLVBhdGggIiRleHRyYWN0UGF0aFxiYWNrYm9uZS1jbGlcYmFja2JvbmUtY2xpXCoiIC1EZXN0aW5hdGlvbiAkZGVzdGluYXRpb25QYXRoIC1SZWN1cnNlIC1Gb3JjZQ0KICAgICAgICBDb3B5LUl0ZW0gLVBhdGggIiRleHRyYWN0UGF0aFxiYWNrYm9uZS1jbGlcYmFja2JvbmUuYmF0IiAtRGVzdGluYXRpb24gIi5cYmFja2JvbmUuYmF0IiAtRm9yY2UNCg0KICAgICAgICAjIEVsaW1pbmEgaWwgZmlsZSBaSVAgb3JpZ2luYXJpbw0KICAgICAgICBSZW1vdmUtSXRlbSAtUGF0aCAkemlwRmlsZVBhdGggLVJlY3Vyc2UgLUZvcmNlDQogICAgICAgIFJlbW92ZS1JdGVtIC1QYXRoICRleHRyYWN0UGF0aCAtUmVjdXJzZSAtRm9yY2UNCg0KICAgICAgICAjIHJlbmFtZSBqYXIgZmlsZXMNCiAgICAgICAgJHNvdXJjZURpcmVjdG9yeSA9ICIkZGVzdGluYXRpb25QYXRoXCIgICMgRGlyZWN0b3J5IGluIGN1aSBzaSB0cm92YW5vIGkgZmlsZSBkYSByaW5vbWluYXJlDQogICAgICAgICRwcmVmaXggPSAiYmFja2JvbmUtY2xpIiAgICAgICAgICAgICAgICAjIFN0cmluZ2EgaW5pemlhbGUgZGVsIG5vbWUgZGVsIGZpbGUNCiAgICAgICAgJG9sZEV4dGVuc2lvbiA9ICIuamFyIiAgICAgICAgICAgICAgICAgICAgICAgICAjIEVzdGVuc2lvbmUgZGVpIGZpbGUgZGEgcmlub21pbmFyZQ0KICAgICAgICAkbmV3UHJlZml4ID0gImJhY2tib25lLWNsaSIgICAgICAgICAgICAgICAgIyBOdW92YSBzdHJpbmdhIGluaXppYWxlIHBlciBpbCBub21lIGRlbCBmaWxlDQoNCiAgICAgICAgIyBPdHRpZW5pIHR1dHRpIGkgZmlsZSBjb3JyaXNwb25kZW50aSBhaSBjcml0ZXJpIGRpIHJpY2VyY2ENCiAgICAgICAgJGZpbGVzID0gR2V0LUNoaWxkSXRlbSAtUGF0aCAkc291cmNlRGlyZWN0b3J5IC1GaWx0ZXIgIiRwcmVmaXgqJG9sZEV4dGVuc2lvbiIgLUZpbGUNCg0KICAgICAgICAjIFBlciBvZ25pIGZpbGUgdHJvdmF0bywgcmlub21pbmFsbw0KICAgICAgICBmb3JlYWNoICgkZmlsZSBpbiAkZmlsZXMpIHsNCiAgICAgICAgICAgICRuZXdOYW1lV2l0aEV4dGVuc2lvbiA9ICJiYWNrYm9uZS1jbGkuamFyIg0KICAgICAgICAgICAgJG5ld1BhdGggPSBKb2luLVBhdGggLVBhdGggJGZpbGUuRGlyZWN0b3J5LkZ1bGxOYW1lIC1DaGlsZFBhdGggJG5ld05hbWVXaXRoRXh0ZW5zaW9uDQogICAgICAgICAgICBSZW5hbWUtSXRlbSAtUGF0aCAkZmlsZS5GdWxsTmFtZSAtTmV3TmFtZSAkbmV3TmFtZVdpdGhFeHRlbnNpb24gLUZvcmNlDQogICAgICAgIH0NCg0KICAgICAgICAkUHJvZ3Jlc3NQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJw0KICAgIH0gZWxzZSB7DQogICAgICAgIFdyaXRlLUhvc3QgInNvbWV0aGluZyB3ZW50IHdyb25nIHdoaWxlIGRvd25sb2FkaW5nIGZpbGVzLiINCiAgICAgICAgZXhpdCAxDQogICAgfQ0KDQogICAgV3JpdGUtSG9zdCAiRmluaXNoZWQgaW5zdGFsbGluZyBCYWNrYm9uZSBDTEkhIg0KICAgIA0KfQ0KDQoNCiMtLS0tLS0tLS0tLS1JbnZva2UtQXp1cmUtQVBJLS0tLS0tLS0tLS0tLS0tLQ0KDQpmdW5jdGlvbiBJbnZva2UtQXp1cmUtQVBJIHsNCiAgICBQYXJhbSgNCiAgICAgICAgICAgIFtzdHJpbmddDQogICAgICAgICAgICAkaG9zdE5hbWUgPSAncGtncycsDQoNCiAgICAgICAgICAgIFtzdHJpbmddDQogICAgICAgICAgICAkbWV0aG9kID0gJ0dFVCcsDQoNCiAgICAgICAgICAgIFtzdHJpbmddDQogICAgICAgICAgICAkcGF0aCwNCg0KICAgICAgICAgICAgW3N0cmluZ10NCiAgICAgICAgICAgICRib2R5X3N0cmluZyA9ICRudWxsLA0KDQogICAgICAgICAgICBbc3RyaW5nXQ0KICAgICAgICAgICAgJHVyaSA9ICRudWxsDQogICAgICAgICkNCg0KICAgICRmaW5hbFVyaQ0KICAgIGlmICgkdXJpKXsNCiAgICAgICAgJGZpbmFsVXJpID0gJHVyaQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRmaW5hbFVyaSA9ICgiaHR0cHM6Ly97MH0uZGV2LmF6dXJlLmNvbS9jZW50cmljby97MX0iIC1mICRob3N0TmFtZSwgJHBhdGgpDQogICAgfQ0KICAgICNkZWZpbmUgaGVhZGVycw0KICAgICRwYXJhbWV0ZXJzPUB7DQogICAgICAgIFVyaSA9ICRmaW5hbFVyaQ0KICAgICAgICBNZXRob2QgPSAkbWV0aG9kDQogICAgICAgIEhlYWRlcnMgPSBAew0KICAgICAgICAgICAgICAgICAgICAiQXV0aG9yaXphdGlvbiIgPSAkQVpfQVVUSE9SSVpBVElPTl9IRUFERVI7IA0KICAgICAgICAgICAgICAgICAgICAiQ29udGVudC1UeXBlIiA9ICJhcHBsaWNhdGlvbi9qc29uIg0KICAgICAgICAgICAgICAgIH0NCiAgICB9DQoNCiAgICBpZiAoICgkbWV0aG9kIC1lcSAnUFVUJykgLW9yICgkbWV0aG9kIC1lcSAnUE9TVCcpIC1vciAoJG1ldGhvZCAtZXEgJ1BBVENIJykpDQogICAgew0KICAgICAgICAkcGFyYW1ldGVycy4iQm9keSIgPSAkYm9keV9zdHJpbmcNCiAgICB9DQoNCiAgICB0cnkgew0KICAgICAgICAkUHJvZ3Jlc3NQcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnICAgICMgU3Vic2VxdWVudCBjYWxscyBkbyBub3QgZGlzcGxheSBVSS4gICAgDQogICAgICAgICRyZXNwb25zZSA9IEludm9rZS1XZWJSZXF1ZXN0IEBwYXJhbWV0ZXJzDQogICAgICAgICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnQ29udGludWUnDQogICAgfSBjYXRjaCB7DQogICAgICAgIFdyaXRlLUhvc3QgIkZhaWxlZCB0byByZXRyaWV2ZSBkYXRhIGZyb20gdGhlIEFQSS4iDQogICAgICAgIFdyaXRlLUhvc3QgJF8uRXhjZXB0aW9uLk1lc3NhZ2UNCiAgICAgICAgZXhpdCAxDQogICAgfSANCiAgICANCiAgICAjV3JpdGUtSG9zdCAiUkVTUE9OU0U6ICIoJHJlc3BvbnNlLkNvbnRlbnQpICgkcmVzcG9uc2UuU3RhdHVzKQ0KDQogICAgaWYgKCgkcmVzcG9uc2UuU3RhdHVzQ29kZSAtbmUgMjAwKSAtYW5kICgkcmVzcG9uc2UuU3RhdHVzQ29kZSAtbmUgMjAyKSl7DQogICAgICAgICNBTiBFUlJPUiBIQVMgT0NDVVJSRUQNCiAgICAgICAgV3JpdGUtSG9zdCAiQU4gRVJST1IgSEFTIE9DQ1VSUkVEIFdISUxFIElOVk9LSU5HIEFQSSINCiAgICAgICAgV3JpdGUtSG9zdCAoJHBhcmFtZXRlcnMgfCBGb3JtYXQtTGlzdCB8IE91dC1TdHJpbmcpDQogICAgICAgIFdyaXRlLUhvc3QgIlJFU1BPTlNFIg0KICAgICAgICBXcml0ZS1Ib3N0ICgkcmVzcG9uc2UgfCBGb3JtYXQtTGlzdCB8IE91dC1TdHJpbmcpDQogICAgfQ0KICAgICRyZXN1bHQgPSAkcmVzcG9uc2UuQ29udGVudCB8IENvbnZlcnRGcm9tLUpzb24NCg0KICAgIGlmICgkcmVzdWx0LnZhbHVlIC1lcSAkbnVsbCl7DQogICAgICAgIHJldHVybiAkcmVzdWx0DQogICAgfQ0KICAgIHJldHVybiAkcmVzdWx0LnZhbHVlDQp9DQojLS0tLS0tLS0tLS0tRU5EIEludm9rZS1BenVyZS1BUEktLS0tLS0tLS0tLS0tLS0tDQoNCmZ1bmN0aW9uIERvd25sb2FkRmlsZSgkdXJsLCAkdGFyZ2V0RmlsZSkNCnsNCiAgICAkUHJvZ3Jlc3NQcmVmZXJlbmNlID0gJ0NvbnRpbnVlJw0KICAgICR3ZWJDbGllbnQgPSBOZXctT2JqZWN0IC1UeXBlTmFtZSBTeXN0ZW0uTmV0LldlYkNsaWVudA0KICAgICR3ZWJDbGllbnQuSGVhZGVyc1snQXV0aG9yaXphdGlvbiddID0gJEFaX0FVVEhPUklaQVRJT05fSEVBREVSOw0KICAgICR0YXNrID0gJHdlYkNsaWVudC5Eb3dubG9hZEZpbGVUYXNrQXN5bmMoJHVybCwgIiRwd2RcJHRhcmdldEZpbGUiKQ0KICAgIA0KICAgIFJlZ2lzdGVyLU9iamVjdEV2ZW50IC1JbnB1dE9iamVjdCAkd2ViQ2xpZW50IC1FdmVudE5hbWUgRG93bmxvYWRQcm9ncmVzc0NoYW5nZWQgLVNvdXJjZUlkZW50aWZpZXIgV2ViQ2xpZW50LkRvd25sb2FkUHJvZ3Jlc3NDaGFuZ2VkIHwgT3V0LU51bGwNCg0KICAgIFN0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgMjUwMA0KICAgIHdoaWxlICghKCR0YXNrLklzQ29tcGxldGVkKSkgew0KICAgICAgICB0cnkgeyANCiAgICAgICAgICAgICRFdmVudERhdGEgPSBHZXQtRXZlbnQgLVNvdXJjZUlkZW50aWZpZXIgV2ViQ2xpZW50LkRvd25sb2FkUHJvZ3Jlc3NDaGFuZ2VkIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgIlNvdXJjZUV2ZW50QXJncyIgLUxhc3QgMQ0KDQogICAgICAgICAgICAkUmVjZWl2ZWREYXRhID0gKCRFdmVudERhdGEgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSAiQnl0ZXNSZWNlaXZlZCIpDQogICAgICAgICAgICAkVG90YWxUb1JlY2VpdmUgPSAoJEV2ZW50RGF0YSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5ICJUb3RhbEJ5dGVzVG9SZWNlaXZlIikNCiAgICAgICAgICAgICRUb3RhbFBlcmNlbnQgPSAkRXZlbnREYXRhIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgIlByb2dyZXNzUGVyY2VudGFnZSINCiAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1NaWxsaXNlY29uZHMgNTAwDQogICAgICAgICAgICBpZiAoJFRvdGFsUGVyY2VudCAtYW5kICRUb3RhbFBlcmNlbnQgLWFuZCAkVG90YWxQZXJjZW50KSB7DQogICAgICAgICAgICAgICAgV3JpdGUtUHJvZ3Jlc3MgLUFjdGl2aXR5ICJEb3dubG9hZGluZyBCYWNrYm9uZSBDTEkiIC1TdGF0dXMgIlBlcmNlbnQgQ29tcGxldGU6ICQoJFRvdGFsUGVyY2VudCklIiAtQ3VycmVudE9wZXJhdGlvbiAiRG93bmxvYWRlZCAkKGNvbnZlcnRGaWxlU2l6ZSAtYnl0ZXMgJFJlY2VpdmVkRGF0YSkgLyAkKGNvbnZlcnRGaWxlU2l6ZSAtYnl0ZXMgJFRvdGFsVG9SZWNlaXZlKSIgLVBlcmNlbnRDb21wbGV0ZSAkVG90YWxQZXJjZW50DQogICAgICAgICAgICB9DQogICAgICAgIH0gY2F0Y2gge30NCiAgICB9DQogICAgU3RhcnQtU2xlZXAgLU1pbGxpc2Vjb25kcyA1MDANCiAgICBXcml0ZS1Qcm9ncmVzcyAtQWN0aXZpdHkgIkRvd25sb2FkaW5nIEJhY2tib25lIENMSSIgLVN0YXR1cyAiUGVyY2VudCBDb21wbGV0ZTogMTAwJSIgLUN1cnJlbnRPcGVyYXRpb24gIkRvd25sb2FkZWQgMTAwIC8gMTAwIiAtUGVyY2VudENvbXBsZXRlIDEwMA0KICAgIFVucmVnaXN0ZXItRXZlbnQgLVNvdXJjZUlkZW50aWZpZXIgV2ViQ2xpZW50LkRvd25sb2FkUHJvZ3Jlc3NDaGFuZ2VkDQogICAgJHdlYkNsaWVudC5EaXNwb3NlKCkNCiAgICAkUHJvZ3Jlc3NQcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnOw0KfQ0KDQpmdW5jdGlvbiBjb252ZXJ0RmlsZVNpemUgew0KICAgIHBhcmFtKA0KICAgICAgICAkYnl0ZXMNCiAgICApDQoNCiAgICBpZiAoJGJ5dGVzIC1sdCAxTUIpIHsNCiAgICAgICAgcmV0dXJuICIkKFtNYXRoXTo6Um91bmQoJGJ5dGVzIC8gMUtCLCAyKSkgS0IiDQogICAgfQ0KICAgIGVsc2VpZiAoJGJ5dGVzIC1sdCAxR0IpIHsNCiAgICAgICAgcmV0dXJuICIkKFtNYXRoXTo6Um91bmQoJGJ5dGVzIC8gMU1CLCAyKSkgTUIiDQogICAgfQ0KICAgIGVsc2VpZiAoJGJ5dGVzIC1sdCAxVEIpIHsNCiAgICAgICAgcmV0dXJuICIkKFtNYXRoXTo6Um91bmQoJGJ5dGVzIC8gMUdCLCAyKSkgR0IiDQogICAgfQ0KfQ0KDQomICRtYWlu\"))));powershell -EncodedCommand $utf16Base64Command"
@REM exit /b

:execute_cmd
"%BACKBONE_JRE_DIR%\java" -cp "%BACKBONE_INSTALL_DIR%" it.sella.backbone.cli.BackboneCli %CMD_ARGS%
@REM exit /b

echo %cmdcmdline%|find /i """%~f0""">nul && SET "LAUNCH_TYPE=doubleClick"  || SET "LAUNCH_TYPE=console"
if "%LAUNCH_TYPE%"=="doubleClick" (
    cmd /k
)